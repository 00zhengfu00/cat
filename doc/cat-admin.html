<p><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"/></head></p>
<h1 id="++">背景</h1>
<p>本文描述了如何部署和维护CAT. 如果你有任何问题, 请联系CAT团队成员.</p>
<hr />
<h1 id="++_1">部署</h1>
<p>你需要增加这个文件:/data/appdatas/cat/server.xml</p>
<pre><code class="xml">&lt;config local-mode=&quot;false&quot;&gt;
        &lt;storage local-base-dir=&quot;/data/appdatas/cat/bucket&quot;&gt;
                &lt;hdfs id=&quot;logview&quot; max-size=&quot;128M&quot; server-uri=&quot;hdfs://10.1.1.169/user/cat&quot; base-dir=&quot;logview&quot;/&gt;
                &lt;hdfs id=&quot;dump&quot; max-size=&quot;128M&quot; server-uri=&quot;hdfs://10.1.1.169/user/cat&quot; base-dir=&quot;dump&quot;/&gt;
                &lt;properties&gt;
                        &lt;property name=&quot;hadoop.security.authentication&quot; value=&quot;kerberos&quot;/&gt;
                        &lt;property name=&quot;dfs.cat.kerberos.principal&quot; value=&quot;cat@DIANPING.COM&quot;/&gt;
                        &lt;property name=&quot;dfs.cat.keytab.file&quot; value=&quot;/data/appdatas/cat/cat.keytab&quot;/&gt;
                        &lt;property name=&quot;java.security.krb5.kdc&quot; value=&quot;10.1.1.170&quot;/&gt;
                        &lt;property name=&quot;dfs.namenode.kerberos.principal&quot; value=&quot;hadoop/10.1.1.169@DIANPING.COM&quot;/&gt;
                        &lt;property name=&quot;java.security.krb5.realm&quot; value=&quot;DIANPING.COM&quot;/&gt;
                &lt;/properties&gt;
        &lt;/storage&gt;
        &lt;consumer&gt;
                &lt;long-url default-threshold=&quot;1000&quot;&gt;
                        &lt;domain name=&quot;Cat&quot; threshold=&quot;500&quot;/&gt;
                &lt;/long-url&gt;
        &lt;/consumer&gt;
        &lt;console default-domain=&quot;MobileApi&quot; show-cat-domain=&quot;true&quot;&gt;
             &lt;remote-servers&gt;10.1.6.48:8080,10.1.6.37:8080&lt;/remote-servers&gt;
        &lt;/console&gt;
&lt;/config&gt;
</code></pre>

<p>同时检查这几个地方:</p>
<ul>
<li>在remote-servers内增加新机器的ip</li>
<li>检查 /data/appdatas/cat/cat.keytab 这个文件是否有效</li>
<li>检查 hdfs://10.1.1.169/user/cat     这个hdfs目录是否有效</li>
</ul>
<hr />
<h1 id="++++">数据清理</h1>
<p>hdfs://10.1.1.169/user/cat/dump 下需要保留近3天的数据, 供分析报表使用. hdfs://10.1.1.169/user/cat/logview 下需要保留近1个月的数据, 供分析报表使用</p>