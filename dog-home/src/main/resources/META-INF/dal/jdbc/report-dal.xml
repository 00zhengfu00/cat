<?xml version="1.0" encoding="UTF-8"?>
<entities do-package="com.dianping.dog.dal" gen="true">

	<entity name="dailyreport" table="dailyreport" alias="dr">
		<member name="count" value-type="int" select-expr="COUNT(*)"
			all="false" />
		<var name="start-date" value-type="Date" />
		<var name="end-date" value-type="Date" />
		<readsets>
			<readset name="DOMAIN_NAME">
				<member name="domain" />
				<member name="name" />
			</readset>
			<readset name="COUNT">
				<member name="count" />
			</readset>
		</readsets>
		<query-defs>
			<query name="insert" type="INSERT">
				<statement><![CDATA[
					INSERT IGNORE INTO <TABLE/>
						(<FIELDS/>) 
					VALUES
						(<VALUES/>)
					]]></statement>
			</query>
			<query name="find-all-by-domain-name-duration" type="SELECT"
				multiple="true">
				<param name="start-date" />
				<param name="end-date" />
				<param name="domain" />
				<param name="name" />
				<statement><![CDATA[
					SELECT <FIELDS/> 
					FROM <TABLE/> 
					WHERE <FIELD name='period'/> >= ${start-date}
					AND <FIELD name='period'/> < ${end-date}
					AND <FIELD name='domain'/> = ${domain}
					AND <FIELD name='name'/> = ${name} 
					AND type = 1
					]]></statement>
			</query>
			<query name="find-by-name-domain-period" type="SELECT">
				<param name="period" />
				<param name="domain" />
				<param name="name" />
				<statement><![CDATA[
					SELECT <FIELDS/> 
					FROM <TABLE/> 
					WHERE <FIELD name='period'/> = ${period}
					<IF type='NOT_NULL' field='domain'>
						AND <FIELD name='domain'/> = ${domain}
					</IF>
					<IF type='NOT_NULL' field='name'>
						AND <FIELD name='name'/> = ${name}
					</IF>	
					AND type = 1				
				]]></statement>
			</query>
			<query name="find-all-by-period" type="SELECT" multiple="true">
				<param name="start-date" />
				<param name="end-date" />
				<statement><![CDATA[
					SELECT <FIELDS/> 
					FROM <TABLE/> 
					WHERE <FIELD name='period'/> >= ${start-date}
					AND <FIELD name='period'/> < ${end-date}
					AND type = 1			
				]]></statement>
			</query>

			<query name="delete-by-domain-name-period" type="DELETE">
				<param name="period" />
				<param name="domain" />
				<param name="name" />
				<statement><![CDATA[
				DELETE FROM <TABLE/> 
				WHERE <FIELD name='period'/> = ${period}
				<IF type='NOT_NULL' field='domain'>
					AND <FIELD name='domain'/> = ${domain}
				</IF>
				<IF type='NOT_NULL' field='name'>
					AND <FIELD name='name'/> = ${name}
				</IF>
				AND type =1;	
				]]></statement>
			</query><query name="find-database-all-by-domain-name-duration" type="SELECT"
				multiple="true">
				<param name="start-date" />
				<param name="end-date" />
				<param name="domain" />
				<param name="name" />
				<statement><![CDATA[
					SELECT <FIELDS/> 
					FROM <TABLE/> 
					WHERE <FIELD name='period'/> >= ${start-date}
					AND <FIELD name='period'/> < ${end-date}
					AND <FIELD name='domain'/> = ${domain}
					AND <FIELD name='name'/> = ${name} 
					AND type = 2
					]]></statement>
			</query>
			<query name="find-database-by-name-domain-period" type="SELECT">
				<param name="period" />
				<param name="domain" />
				<param name="name" />
				<statement><![CDATA[
					SELECT <FIELDS/> 
					FROM <TABLE/> 
					WHERE <FIELD name='period'/> = ${period}
					<IF type='NOT_NULL' field='domain'>
						AND <FIELD name='domain'/> = ${domain}
					</IF>
					<IF type='NOT_NULL' field='name'>
						AND <FIELD name='name'/> = ${name}
					</IF>	
					AND type = 2				
				]]></statement>
			</query>
			<query name="find-database-all-by-period" type="SELECT" multiple="true">
				<param name="start-date" />
				<param name="end-date" />
				<statement><![CDATA[
					SELECT <FIELDS/> 
					FROM <TABLE/> 
					WHERE <FIELD name='period'/> >= ${start-date}
					AND <FIELD name='period'/> < ${end-date}
					AND type =2			
				]]></statement>
			</query>

			<query name="delete-database-by-domain-name-period" type="DELETE">
				<param name="period" />
				<param name="domain" />
				<param name="name" />
				<statement><![CDATA[
				DELETE FROM <TABLE/> 
				WHERE <FIELD name='period'/> = ${period}
				<IF type='NOT_NULL' field='domain'>
					AND <FIELD name='domain'/> = ${domain}
				</IF>
				<IF type='NOT_NULL' field='name'>
					AND <FIELD name='name'/> = ${name}
				</IF>
				AND type =2;	
				]]></statement>
			</query>

		</query-defs>
	</entity>
<entity name="ruleinstance" table="ruleinstance" alias="r">
	<member name="creation-date" insert-expr="NOW()" />
	<member name="last-modified-date" insert-expr="NOW()"
		update-expr="NOW()" />
	<query-defs>
		<query name="find-all-instance" type="SELECT"  multiple="true">
			<statement><![CDATA[
				SELECT <FIELDS/> 
				FROM <TABLE/> 
				]]></statement>
		</query>
	</query-defs>
</entity>
<entity name="subscriber" table="subscriber" alias="r">
	<query-defs>
		<query name="find-all-subscriber" type="SELECT"  multiple="true">
			<statement><![CDATA[
				SELECT <FIELDS/> 
				FROM <TABLE/> 
				]]></statement>
		</query>
		<query name="find-all-subscriber-by-domain" type="SELECT"  multiple="true">
		    <param name="domain" />
		    <param name="type" />
			<statement><![CDATA[		
				SELECT <FIELDS/> 
				FROM <TABLE/> 
				WHERE <FIELD name='domain'/> >= ${domain} 
				AND <FIELD name='type'/> = ${type} 
				]]></statement>
		</query>
	</query-defs>
</entity>
<entity name="dailyreport" table="dailyreport" alias="r">
	<query-defs>
		<query name="find-distinct-report-domain" type="SELECT"  multiple="true">
		    <param name="start-date" />
		    <param name="end-date" />
		    <param name="type" />
			<statement><![CDATA[
        	    SELECT DISTINCT <FIELD name='domain'/>
        	    FROM <TABLE/> 
			    WHERE <FIELD name='period'/> >= ${start-date} 
			    AND <FIELD name='period'/>  <= ${end-date} 
			    AND ( <FIELD name='name'/>  = 'event'
			          OR  <FIELD name='name'/>  = 'problem'
			          OR  <FIELD name='name'/>  = 'transaction'
                )
                AND <FIELD name='type'/> = ${type} 
				]]></statement>
		</query>
	</query-defs>
</entity>
</entities>








